TODO: update the code, add adversarial test sets
